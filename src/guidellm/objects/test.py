from typing import List, Tuple

from guidellm.objects.statistics import DistributionSummary


def generate_stats_outputs_tokens_per_seconds(
    requests: List[Tuple[float, float]],
    first_token_times: List[float],
    output_token_counts: List[int],
    epsilon: float = 1e-6,
):
    distribution = DistributionSummary.from_iterable_request_times(
        requests=requests,
        first_iter_times=first_token_times,
        iter_counts=output_token_counts,
        epsilon=epsilon,
    )
    print(distribution)


def generate_stats_inter_token_latencies(
    latencies: List[float],
    weights: List[float] = None,
    epsilon: float = 1e-6,
):
    distribution = DistributionSummary.from_values(latencies, weights)
    print(distribution)


def generate_stats_requests_per_second(
    requests: List[Tuple[float, float]],
    epsilon: float = 1e-6,
) -> List[Tuple[float, float]]:
    distribution = DistributionSummary.from_request_times(
        requests, "rate", epsilon=epsilon
    )
    print(distribution)


def generate_stats_concurrent_requests(
    requests=List[Tuple[float, float]],
    epsilon: float = 1e-6,
):
    distribution = DistributionSummary.from_request_times(
        requests, "concurrency", epsilon
    )
    print(distribution)


# Example Usage

request_times = [
    (1743163300.403223, 1743163301.9923513),
    (1743163300.4043713, 1743163302.015711),
    (1743163300.407332, 1743163302.0157585),
    (1743163300.4105933, 1743163302.0158577),
    (1743163300.4118826, 1743163302.015753),
    (1743163302.0636709, 1743163303.6263561),
    (1743163302.0829957, 1743163303.64966),
    (1743163302.0883937, 1743163303.6496801),
    (1743163302.0896976, 1743163303.6497076),
    (1743163302.0892832, 1743163303.649676),
    (1743163303.701261, 1743163305.26519),
    (1743163303.7232263, 1743163305.2885003),
    (1743163303.7202537, 1743163305.2885823),
    (1743163303.7239172, 1743163305.2885487),
    (1743163303.7244577, 1743163305.288734),
    (1743163305.3386924, 1743163306.9014742),
    (1743163305.3575644, 1743163306.9247215),
    (1743163305.364691, 1743163306.9247289),
    (1743163305.3667543, 1743163306.9247417),
    (1743163305.3670223, 1743163306.9247096),
    (1743163306.972128, 1743163308.5344012),
    (1743163306.997972, 1743163308.5577517),
    (1743163306.9919195, 1743163308.5577645),
    (1743163306.998968, 1743163308.5578134),
    (1743163306.9986732, 1743163308.5578017),
    (1743163308.6057122, 1743163310.172029),
    (1743163308.6297, 1743163310.1953459),
    (1743163308.6132185, 1743163310.1953993),
    (1743163308.630173, 1743163310.195401),
    (1743163308.6345012, 1743163310.1953926),
    (1743163310.2397547, 1743163311.801659),
    (1743163310.2674718, 1743163311.824895),
    (1743163310.2598615, 1743163311.8248944),
    (1743163310.2720146, 1743163311.824908),
    (1743163310.2664378, 1743163311.8248801),
    (1743163311.8722754, 1743163313.4339283),
    (1743163311.900499, 1743163313.457236),
    (1743163311.895735, 1743163313.4572852),
    (1743163311.8999357, 1743163313.457477),
    (1743163311.8968449, 1743163313.4572716),
    (1743163313.5064678, 1743163315.068746),
    (1743163313.5301821, 1743163315.0921736),
    (1743163313.5289028, 1743163315.092185),
    (1743163313.5287688, 1743163315.0922654),
    (1743163313.5301483, 1743163315.092442),
    (1743163315.1421392, 1743163316.705413),
    (1743163315.1619313, 1743163316.7287838),
    (1743163315.1561904, 1743163316.7287745),
    (1743163315.1638331, 1743163316.7288203),
    (1743163315.1655514, 1743163316.7288005),
    (1743163316.7788277, 1743163318.340335),
    (1743163316.8018036, 1743163318.363607),
    (1743163316.8013813, 1743163318.3635497),
    (1743163316.7962375, 1743163318.3637505),
    (1743163316.8082492, 1743163318.3635893),
    (1743163318.4177032, 1743163319.9805896),
    (1743163318.4415567, 1743163320.0040746),
    (1743163318.438249, 1743163320.0040603),
    (1743163318.4454482, 1743163320.0039873),
    (1743163318.435946, 1743163320.0040472),
    (1743163320.059263, 1743163321.6231477),
    (1743163320.0803068, 1743163321.646229),
    (1743163320.077479, 1743163321.6461928),
    (1743163320.077346, 1743163321.646171),
    (1743163320.0767386, 1743163321.6462295),
    (1743163321.6983657, 1743163323.262142),
    (1743163321.720098, 1743163323.2855532),
    (1743163321.7210836, 1743163323.2855496),
    (1743163321.7272742, 1743163323.285537),
    (1743163321.720461, 1743163323.285713),
    (1743163323.3382583, 1743163324.9130867),
    (1743163323.3578243, 1743163324.9363666),
    (1743163323.3580399, 1743163324.9365273),
    (1743163323.3582692, 1743163324.9365368),
    (1743163323.3700652, 1743163324.9365063),
    (1743163324.9848232, 1743163326.548244),
    (1743163325.0123115, 1743163326.5716817),
    (1743163325.0087984, 1743163326.57175),
    (1743163325.0095794, 1743163326.571734),
    (1743163325.0168707, 1743163326.5717053),
    (1743163326.61861, 1743163328.1839957),
    (1743163326.633079, 1743163328.2074084),
    (1743163326.6254075, 1743163328.207643),
    (1743163326.642937, 1743163328.207623),
    (1743163326.628424, 1743163328.2074928),
    (1743163328.2542157, 1743163329.8191519),
    (1743163328.2807877, 1743163329.842159),
    (1743163328.2869048, 1743163329.8421898),
    (1743163328.2784348, 1743163329.8422613),
    (1743163328.3039563, 1743163329.8646753),
    (1743163329.8803456, 1743163331.4419262),
    (1743163329.8897858, 1743163331.4652398),
    (1743163329.9109275, 1743163331.4652941),
    (1743163329.8975961, 1743163331.4653),
    (1743163329.8834872, 1743163331.4652634),
    (1743163331.5126238, 1743163333.0786362),
    (1743163331.5387557, 1743163333.1019342),
    (1743163331.5308228, 1743163333.1019886),
    (1743163331.5362875, 1743163333.1019595),
    (1743163331.5372543, 1743163333.1019611),
]
first_token_times = [
    1743163300.4774668,
    1743163300.5430598,
    1743163300.5430408,
    1743163300.5430439,
    1743163300.5430408,
    1743163302.1260648,
    1743163302.1790159,
    1743163302.1789834,
    1743163302.178902,
    1743163302.1788735,
    1743163303.7622797,
    1743163303.8150222,
    1743163303.8150568,
    1743163303.815119,
    1743163303.8151877,
    1743163305.400849,
    1743163305.4539392,
    1743163305.4539232,
    1743163305.4539037,
    1743163305.4538555,
    1743163307.0341141,
    1743163307.0872338,
    1743163307.0871842,
    1743163307.0872376,
    1743163307.0871847,
    1743163308.6717093,
    1743163308.7247245,
    1743163308.7246864,
    1743163308.7246675,
    1743163308.7246442,
    1743163310.3007226,
    1743163310.3539567,
    1743163310.3539433,
    1743163310.3539903,
    1743163310.353892,
    1743163311.9333777,
    1743163311.9865408,
    1743163311.9865537,
    1743163311.9865468,
    1743163311.9865608,
    1743163313.5681715,
    1743163313.6213248,
    1743163313.6213076,
    1743163313.6213694,
    1743163313.6212204,
    1743163315.2052338,
    1743163315.257879,
    1743163315.2578883,
    1743163315.2578585,
    1743163315.2578545,
    1743163316.839769,
    1743163316.8927107,
    1743163316.8927133,
    1743163316.8925958,
    1743163316.8925962,
    1743163318.4791622,
    1743163318.5325277,
    1743163318.53261,
    1743163318.5324767,
    1743163318.5324028,
    1743163320.1203272,
    1743163320.1740332,
    1743163320.1739714,
    1743163320.174067,
    1743163320.174065,
    1743163321.759952,
    1743163321.813341,
    1743163321.813346,
    1743163321.8132503,
    1743163321.8133996,
    1743163323.410784,
    1743163323.464367,
    1743163323.4643219,
    1743163323.4643698,
    1743163323.4643369,
    1743163325.0459666,
    1743163325.0997808,
    1743163325.0997987,
    1743163325.099642,
    1743163325.0997283,
    1743163326.681901,
    1743163326.7354028,
    1743163326.7354014,
    1743163326.735491,
    1743163326.7354689,
    1743163328.3170884,
    1743163328.3714006,
    1743163328.3715012,
    1743163328.3715947,
    1743163328.3944945,
    1743163329.9375503,
    1743163329.9934423,
    1743163329.9931898,
    1743163329.9932914,
    1743163329.9932675,
    1743163331.5760312,
    1743163331.629882,
    1743163331.6298609,
    1743163331.6300056,
    1743163331.6299996,
]
output_tokens = [
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
    64,
]


generate_stats_outputs_tokens_per_seconds(
    request_times,
    first_token_times,
    output_tokens,
)
